<section id="pbest01">
   <h3>Q.　以下の仮想の物件のなかから，あなたにとって望ましい物件を<div0>2つ</div0>選んでチェックしてください。</h3>
     <br />     
     
   <table border="1" width="75%" height="200" id="ptable01" >
   <tr><td width="150" height="80" align="center"></td>
         <td width="150" height="80" align="center"><input type="checkbox" value="1" class="geomsize" onclick="recordPbest01(this);pcnt01();"></td>
         <td width="150" height="80" align="center"><input type="checkbox" value="2" class="geomsize" onclick="recordPbest01(this);pcnt01();"></td>
         <td width="150" height="80" align="center"><input type="checkbox" value="3" class="geomsize" onclick="recordPbest01(this);pcnt01();"></td>
         <td width="150" height="80" align="center"><input type="checkbox" value="4" class="geomsize" onclick="recordPbest01(this);pcnt01();"></td>
         <td width="150" height="80" align="center"><input type="checkbox" value="5" class="geomsize" onclick="recordPbest01(this);pcnt01();"></td>
         <td width="150" height="80" align="center"><input type="checkbox" value="6" class="geomsize" onclick="recordPbest01(this);pcnt01();"></td>
  </tr>
   <?!=getNm()?> <?!=getTr("cc00"); ?>        
   </table>
   <br /> 
   <div id="pBox01">チェックを入れてください。</div>
   <style>
   div0 { color:red; } 
      
   </style>
   <br clear="all"><br />
   <hr>
   <button onclick="show_pbest02();">次へ</button>
   <hr>
   <script>
   function pcnt01() {
   var Myobj = document.getElementById("ptable01"); // id名が "ptable01"内のオブジェクトを Myobj に格納
   var Mytag = Myobj.getElementsByTagName("input"); // Myobj 内の "input"タグ要素を格納
   var chksuu = 0; //チェックの数のカウンタ
　　　for (var i = 0; i < Mytag.length; i ++) { //Mytag.length; チェックボックスの数
　　　　　if (Mytag[i].checked == true) { //checked == trueであればチェック有り
　　　　　　　　chksuu ++; // trueであれば １ずつ加算します
　　　　　　　　　　　}
　　　　　}
　　　　　      msg = "チェックの数は " + chksuu + "個です";
              document.getElementById("pBox01").innerHTML=msg; // メッセージを"tBox"に書き込みます
    }

    function show_pbest02() {
	var tableElement = document.getElementById("ptable01");
	var row = tableElement.rows[0];
	var cells = row.cells;
	var trueCount = 0;
	for (var i in cells) {
		var cell = cells[i];
		if (cell === undefined || cell === null) {
			continue;
		}
		if (cell.children === undefined || cell.children === null) {
			continue;
		}
		var inputElement = cell.children[0];
		if (inputElement === undefined || inputElement === null) {
			continue;
		}
		if (inputElement.checked) {
			trueCount += 1;
		}
	}
        
	if (trueCount == 0) {
	   alert("チェックされていません。");  
	} else if (trueCount !== 2) {
	   alert("ちょうど2個だけ選んでください。");  
	} else {
		//alert("3個選んでくれてありがとう");
		//ここに次のページへの遷移のためのコードを書く
       var sections = document.getElementsByTagName("section");
       end_pbest01 = (new Date()).getTime();
       for(var i=0; i<sections.length; ++i) {
       sections[i].style.display="none";
       }
       document.getElementById("pbest02").style.display="block";                
     }
	}

     function recordPbest01(element){
//       var start_time = start_time;            //誰が
       var click_time = (new Date()).getTime();  //いつ
       var element_value = element.value;        //値
       var element_checked = element.checked;    //チェック状態
       google.script.run.withFailureHandler(function(){
       }).withSuccessHandler(function(){
       }).recordPbest01(start_time, end_pbest00,click_time, "pbest01", element_value, element_checked);
     } recordPbest01(element);

   </script>
</section>
<section id="rank03">
   <h3>Q.　以下の仮想の物件を、あなたにとって望ましい順に選んでお答えください。<br />
      　　なお、全ての物件に順位をお答えいただく必要はございません。
   </h3>
   <br />   
   <table border="1" width="75%" height="200">
      <tr><td width="150" height="80" align="center"></td>
         <td width="150" height="80" align="center">
            <select name="順位" id="rank031" onchange="recordrank03(this)">
               <option value="0">順位</option>
               <option value="1">1位</option>
               <option value="2">2位</option>
               <option value="3">3位</option>
               <option value="4">4位</option>
               <option value="5">5位</option>
               <option value="6">6位</option>
               <option value="7">7位</option>
               <option value="8">8位</option>
            </select>
         </td>
         <td width="150" height="80" align="center">
            <select name="順位" id="rank032" onchange="recordrank03(this)">
               <option value="0">順位</option>
               <option value="1">1位</option>
               <option value="2">2位</option>
               <option value="3">3位</option>
               <option value="4">4位</option>
               <option value="5">5位</option>
               <option value="6">6位</option>
               <option value="7">7位</option>
               <option value="8">8位</option>
            </select>
         </td>
         <td width="150" height="80" align="center">
            <select name="順位" id="rank033" onchange="recordrank03(this)">
               <option value="0">順位</option>
               <option value="1">1位</option>
               <option value="2">2位</option>
               <option value="3">3位</option>
               <option value="4">4位</option>
               <option value="5">5位</option>
               <option value="6">6位</option>
               <option value="7">7位</option>
               <option value="8">8位</option>
            </select>
         </td>
         <td width="150" height="80" align="center">
            <select name="順位" id="rank034" onchange="recordrank03(this)">
               <option value="0">順位</option>
               <option value="1">1位</option>
               <option value="2">2位</option>
               <option value="3">3位</option>
               <option value="4">4位</option>
               <option value="5">5位</option>
               <option value="6">6位</option>
               <option value="7">7位</option>
               <option value="8">8位</option>
            </select>
         </td>
         <td width="150" height="80" align="center">
            <select name="順位" id="rank035" onchange="recordrank03(this)">
               <option value="0">順位</option>
               <option value="1">1位</option>
               <option value="2">2位</option>
               <option value="3">3位</option>
               <option value="4">4位</option>
               <option value="5">5位</option>
               <option value="6">6位</option>
               <option value="7">7位</option>
               <option value="8">8位</option>
            </select>
         </td>
         <td width="150" height="80" align="center">
            <select name="順位" id="rank036" onchange="recordrank03(this)">
               <option value="0">順位</option>
               <option value="1">1位</option>
               <option value="2">2位</option>
               <option value="3">3位</option>
               <option value="4">4位</option>
               <option value="5">5位</option>
               <option value="6">6位</option>
               <option value="7">7位</option>
               <option value="8">8位</option>
            </select>
         </td>
         <td width="150" height="80" align="center">
            <select name="順位" id="rank037" onchange="recordrank03(this)">
               <option value="0">順位</option>
               <option value="1">1位</option>
               <option value="2">2位</option>
               <option value="3">3位</option>
               <option value="4">4位</option>
               <option value="5">5位</option>
               <option value="6">6位</option>
               <option value="7">7位</option>
               <option value="8">8位</option>
            </select>
         </td>
         <td width="150" height="80" align="center">
            <select name="順位" id="rank038" onchange="recordrank03(this)">
               <option value="0">順位</option>
               <option value="1">1位</option>
               <option value="2">2位</option>
               <option value="3">3位</option>
               <option value="4">4位</option>
               <option value="5">5位</option>
               <option value="6">6位</option>
               <option value="7">7位</option>
               <option value="8">8位</option>
            </select>
         </td>
      </tr>
      <?!=getNm()?><?!=getTr("cc07"); ?>
   </table>
   <br clear="all"><br />
   <hr>
   <button onclick="show_rank34();">次へ</button>
   <hr>
</section>
<script>
function show_rank34() {
	var values = [];
	values[0] = document.getElementById("rank031").value;
	values[1] = document.getElementById("rank032").value;
	values[2] = document.getElementById("rank033").value;
	values[3] = document.getElementById("rank034").value;
	values[4] = document.getElementById("rank035").value;
	values[5] = document.getElementById("rank036").value;
    values[6] = document.getElementById("rank037").value;
	values[7] = document.getElementById("rank038").value;    
	var counts = [0, 0, 0, 0, 0, 0, 0, 0, 0];
	for (var i in values) {
		counts[values[i]] += 1;
	}
	if (!(counts[1]===1 && counts[2]<=counts[1] && counts[3]<=counts[2]&& counts[4]<=counts[3] && counts[5]<=counts[4] && counts[6]<=counts[5] && counts[7]<=counts[6] && counts[8]<=counts[7])){
		alert("重複している，または順位が入力されていません。");
		return;
    }
//    alert("ありがとうございました");
	end_rank03 = (new Date()).getTime();
	var sections = document.getElementsByTagName("section");
	for (var i = 0; i < sections.length; ++i) {
		sections[i].style.display = "none";
	}
	document.getElementById("rank34").style.display = "block";
}

function recordrank03(element) {
	//       var start_time = start_time;            //誰が
	var click_time = (new Date()).getTime(); //いつ
	var element_value = element.value; //値
	var element_id = element.id; //チェック状態
	google.script.run.withFailureHandler(function () {
    }).withSuccessHandler(function () {
    }).recordrank03(start_time, end_best22, click_time, element_id, element_value);
  }
recordrank03(element);
</script>

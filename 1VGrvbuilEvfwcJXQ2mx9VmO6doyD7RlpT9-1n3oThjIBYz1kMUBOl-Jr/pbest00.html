<section id="pbest00">
   <h3>Q.　以下の仮想の物件のなかから、あなたにとって望ましい物件を選んでチェックしてください。<br />
   　　なお，お答えいただく物件は<div0>いくつでも</div0>かまいません。
    </h3>
     <br />     
     
   <table border="1" width="75%" height="200" id="ptable00" >
   <tr>
   <td width="150" height="80" align="center"></td>
         <td width="150" height="80" align="center"><input type="checkbox" class="geomsize" value="1" id="pbest001" onclick="recordPbest00(this);pcnt00();"></td>
         <td width="150" height="80" align="center"><input type="checkbox" class="geomsize" value="2" id="pbest002" onclick="recordPbest00(this);pcnt00();"></td>
         <td width="150" height="80" align="center"><input type="checkbox" class="geomsize" value="3" id="pbest003" onclick="recordPbest00(this);pcnt00();"></td>
         <td width="150" height="80" align="center"><input type="checkbox" class="geomsize" value="4" id="pbest004" onclick="recordPbest00(this);pcnt00();"></td>
         <td width="150" height="80" align="center"><input type="checkbox" class="geomsize" value="5" id="pbest005" onclick="recordPbest00(this);pcnt00();"></td>
         <td width="150" height="80" align="center"><input type="checkbox" class="geomsize" value="6" id="pbest006" onclick="recordPbest00(this);pcnt00();"></td>
  </tr>
   <?!=getNm()?> <?!=getTr("cc00"); ?>        
   </table>
   <br /> 
   <div id="pBox00">チェックを入れてください。</div>
   <style>
   div0 { color:red; } 
      
   </style>
   <br clear="all"><br />
   <hr>
   <button onclick="show_pbest01();">次へ</button>
   <hr>
   <script>
   function pcnt00() {
   var Myobj = document.getElementById("ptable00"); // id名が "ptable00"内のオブジェクトを Myobj に格納
   var Mytag = Myobj.getElementsByTagName("input"); // Myobj 内の "input"タグ要素を格納
   var chksuu = 0; //チェックの数のカウンタ
　　　for (var i = 0; i < Mytag.length; i ++) { //Mytag.length; チェックボックスの数
　　　　　if (Mytag[i].checked == true) { //checked == trueであればチェック有り
　　　　　　　　chksuu ++; // trueであれば １ずつ加算します
　　　　　　　　　　　}
　　　　　}
　　　　　      msg = "チェックの数は " + chksuu + "個です";
              document.getElementById("pBox00").innerHTML=msg; // メッセージを"tBox"に書き込みます
    }

    function show_pbest01() {
	var tableElement = document.getElementById("ptable00");
	var row = tableElement.rows[0];
	var cells = row.cells;
	var trueCount = 0;
	for (var i in cells) {
		var cell = cells[i];
		if (cell === undefined || cell === null) {
			continue;
		}
		if (cell.children === undefined || cell.children === null) {
			continue;
		}
		var inputElement = cell.children[0];
		if (inputElement === undefined || inputElement === null) {
			continue;
		}
		if (inputElement.checked) {
			trueCount += 1;
		}
	}
        
	if (trueCount == 0) {
	   alert("回答が入力されていません。");
	} else {
		//alert("3個選んでくれてありがとう");
		//ここに次のページへの遷移のためのコードを書く
       var sections = document.getElementsByTagName("section");
       end_pbest00 = (new Date()).getTime();
       for(var i=0; i<sections.length; ++i) {
       sections[i].style.display="none";
       }
       document.getElementById("pbest01").style.display="block";                
     }
	}

     function recordPbest00(element){
//       var start_time = start_time;            //誰が
       var click_time = (new Date()).getTime();  //いつ
       var element_id = element.id;              //何を
       var element_value = element.value;        //値
       var element_checked = element.checked;    //チェック状態
       google.script.run.withFailureHandler(function(){
       }).withSuccessHandler(function(){
       }).recordPbest00(start_time, end_prank02, click_time, "pbest00", element_value, element_checked);
     } recordPbest00(element);

   </script>
</section>
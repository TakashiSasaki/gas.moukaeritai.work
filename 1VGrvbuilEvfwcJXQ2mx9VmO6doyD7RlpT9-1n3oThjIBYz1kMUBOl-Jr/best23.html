<section id="best23">
   <h3>Q.　以下の仮想の物件のなかから、あなたにとって望ましい物件を<div0>3つ</div0>選んでチェックしてください。</h3>
     <br />     
     
   <table border="1" width="75%" height="200" id="table23" >
   <tr><td width="150" height="80" align="center"></td>
         <td width="150" height="80" align="center"><input type="checkbox" class="geomsize" value="1" id="best231" onclick="recordbest23(this);cnt23();"></td>
         <td width="150" height="80" align="center"><input type="checkbox" class="geomsize" value="2" id="best232" onclick="recordbest23(this);cnt23();"></td>
         <td width="150" height="80" align="center"><input type="checkbox" class="geomsize" value="3" id="best233" onclick="recordbest23(this);cnt23();"></td>
         <td width="150" height="80" align="center"><input type="checkbox" class="geomsize" value="4" id="best234" onclick="recordbest23(this);cnt23();"></td>
         <td width="150" height="80" align="center"><input type="checkbox" class="geomsize" value="5" id="best235" onclick="recordbest23(this);cnt23();"></td>
         <td width="150" height="80" align="center"><input type="checkbox" class="geomsize" value="6" id="best236" onclick="recordbest23(this);cnt23();"></td>
         <td width="150" height="80" align="center"><input type="checkbox" class="geomsize" value="7" id="best237" onclick="recordbest23(this);cnt23();"></td>
         <td width="150" height="80" align="center"><input type="checkbox" class="geomsize" value="8" id="best238" onclick="recordbest23(this);cnt23();"></td>
  </tr>
   <?!=getNm()?><?!=getTr("cc35"); ?>        
   </table>
   <br /> 
   <div id="Box23">チェックを入れてください。</div>
   <style>
   div0 { color:red; } 
      
   </style>
   <br clear="all"><br />
   <hr>
   <button onclick="show_rank44();">次へ</button>
   <hr>
   <script>
   function cnt23() {
   var Myobj = document.getElementById("table23"); // id名が "ptable00"内のオブジェクトを Myobj に格納
   var Mytag = Myobj.getElementsByTagName("input"); // Myobj 内の "input"タグ要素を格納
   var chksuu = 0; //チェックの数のカウンタ
　　　for (var i = 0; i < Mytag.length; i ++) { //Mytag.length; チェックボックスの数
　　　　　if (Mytag[i].checked == true) { //checked == trueであればチェック有り
　　　　　　　　chksuu ++; // trueであれば １ずつ加算します
　　　　　　　　　　　}
　　　　　}
　　　　　      msg = "チェックの数は " + chksuu + "個です";
              document.getElementById("Box23").innerHTML=msg; // メッセージを"tBox"に書き込みます
    }

    function show_rank44() {
	var tableElement = document.getElementById("table23");
	var row = tableElement.rows[0];
	var cells = row.cells;
	var trueCount = 0;
	for (var i in cells) {
		var cell = cells[i];
		if (cell === undefined || cell === null) {
			continue;
		}
		if (cell.children === undefined || cell.children === null) {
			continue;
		}
		var inputElement = cell.children[0];
		if (inputElement === undefined || inputElement === null) {
			continue;
		}
		if (inputElement.checked) {
			trueCount += 1;
		}
	}
        
	if (trueCount == 0) {
	   alert("チェックされていません。");  
	} else if (trueCount !== 3) {
	   alert("ちょうど3個だけ選んでください。");  
	} else {
		//alert("3個選んでくれてありがとう");
		//ここに次のページへの遷移のためのコードを書く
       var sections = document.getElementsByTagName("section");
       end_best23 = (new Date()).getTime();
       for(var i=0; i<sections.length; ++i) {
       sections[i].style.display="none";
       }
       document.getElementById("rank44").style.display="block";                
     }
	}

     function recordbest23(element){
//       var start_time = start_time;            //誰が
       var click_time = (new Date()).getTime();  //いつ
       var element_id = element.id;              //何を
       var element_value = element.value;        //値
       var element_checked = element.checked;    //チェック状態
       google.script.run.withFailureHandler(function(){
       }).withSuccessHandler(function(){
       }).recordbest23(start_time, end_rest02,click_time, "best23", element_value, element_checked);
     } recordbest23(element);

   </script>
</section>